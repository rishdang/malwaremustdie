#GooDork.py Tips for Mac OS-X - for the usage to analyze and to confirm web-based malicious infection cases.

# Introduction #

Due to checking the web-base malware infection in the internet that is rapidly grow, we think is necessary to share to fellow researchers and authority the simple tool that is very useful for analysis of any malware infected sites. Like most of you do, thank's to  Google for their hard work in search engine, we are using Dork for some query of malware url purpose. Since most of our members works in a shell than UI environment we found and (now) share the good UI tools developed and maintained by @k3170Makan (twitter) in Git called GooDork, a python base command line interface for Google dork.

# Notes about Installation Guide in this Wiki #

GooDork works perfectly under Linux environment, but some users look having problem in installation in FreeBSD and/or Mac OSX, so I will not write about the installation in Linux but will go directly to the Mac OSX setup. FreeBSD (and Linux) users can actually use outline of installation for their system. I run GooDork now in Linux(Debian, Slackware), FreeBSD 9.1., Mac OSX(Mountain Lion) and OpenSolaris 10 without any significant problem.

# Notes & Credits #

Google Search is copyright by Google,.Inc. to be used accordingly under the below policy and term of service only:
<https://www.google.com/intl/en/policies/ >
This article, the writer, the publisher entity or the author of the tool is not responsible and forbid the improper used of the current tool. The tool can be used as per it is (and to be noted) without any warranty.
GooDork project is created & maintained by @k3170Makan (Twitter) shared  GitHub (github.com) with the following access URL: <https://github.com/k3170makan/GooDork >. With the following license information:
<https://github.com/k3170makan/GooDork/blob/master/LICENSE >.

GooDork is copyrighted under GNU General Public License.

We thank the author @k3170Makan (twitter) for letting us use and share the good tool, and to @0xerror (twitter) for the introduction.

# Details #


**Requirement**

It is important that you have the Mac OS-X with the Mac Port installed.
Please get it from here The MacPorts Project  <http://www.macports.org >

You need to check the python version, with firstly just double taps your python command in shell to know which python commands are available in your system. i.e.:
```
$ python [double taps]

python            python2.5         python2.6         python2.7         python3.2         python3.3         
pythonw           pythonw2.6        pythonw3.2        python-config     python2.5-config  python2.6-config  
python2.7-config  python3.2-config  python3.3-config  pythonw2.5        pythonw2.7        pythonw3.3 
```

Secondly, assuming you now have an updated mac ports, try below command to know which python package is installed, i.e.:
```
$ sudo port installed|grep python
Password:
  python27 @2.7.3_1
  python27 @2.7.5_0 (active)
  python32 @3.2.5_0 (active)
  python33 @3.3.1_0
  python33 @3.3.2_0 (active)
  python_select @0.3_2 (active)

// or.. the below command with same result:

$ sudo port installed python*
The following ports are currently installed:
  python27 @2.7.3_1
  python27 @2.7.5_0 (active)
  python32 @3.2.5_0 (active)
  python33 @3.3.1_0
  python33 @3.3.2_0 (active)
  python_select @0.3_2 (active)
```


You need to get the beautifulsoup <http://www.crummy.com/software/BeautifulSoup/ > now, mac ports is preparing those versions that depends on your python versions. This is how you confirm the version of beautifulsoup via MacPorts:
```
$ sudo port search BeautifulSoup
py-beautifulsoup @3.2.1 (python, textproc)
    Python HTML/XML parser

py-beautifulsoup4 @4.1.1 (python, textproc)
    Python HTML/XML parser

py24-beautifulsoup @3.2.1 (python, textproc)
    Python HTML/XML parser

py25-beautifulsoup @3.2.1 (python, textproc)
    Python HTML/XML parser

py25-beautifulsoup4 @4.1.1 (python, textproc)
    Python HTML/XML parser

py26-beautifulsoup @3.2.1 (python, textproc)
    Python HTML/XML parser

py26-beautifulsoup4 @4.1.1 (python, textproc)
    Python HTML/XML parser

py27-beautifulsoup @3.2.1 (python, textproc)
    Python HTML/XML parser

py27-beautifulsoup4 @4.1.1 (python, textproc)
    Python HTML/XML parser

py31-beautifulsoup4 @4.1.1 (python, textproc)
    Python HTML/XML parser

py32-beautifulsoup4 @4.1.1 (python, textproc)
    Python HTML/XML parser

Found 11 ports.
```

In our case here I am preparing python 3.2 and 2.7
```
// for python 2.7

$ sudo port install py27-beautifulsoup4
--->  Computing dependencies for py27-beautifulsoup4
--->  Dependencies to be installed: py27-html5lib py27-distribute py27-lxml
--->  Fetching archive for py27-distribute
--->  Attempting to fetch py27-distribute-0.6.45_0.darwin_12.noarch.tbz2 from http://jog.id.packages.macports.org/macports/packages/py27-distribute
--->  Attempting to fetch py27-distribute-0.6.45_0.darwin_12.noarch.tbz2.rmd160 from http://jog.id.packages.macports.org/macports/packages/py27-distribute
--->  Installing py27-distribute @0.6.45_0
--->  Activating py27-distribute @0.6.45_0
--->  Cleaning py27-distribute
--->  Fetching archive for py27-html5lib
--->  Attempting to fetch py27-html5lib-0.95_0.darwin_12.noarch.tbz2 from http://jog.id.packages.macports.org/macports/packages/py27-html5lib
--->  Attempting to fetch py27-html5lib-0.95_0.darwin_12.noarch.tbz2.rmd160 from http://jog.id.packages.macports.org/macports/packages/py27-html5lib
--->  Installing py27-html5lib @0.95_0
--->  Activating py27-html5lib @0.95_0
--->  Cleaning py27-html5lib
--->  Fetching archive for py27-lxml
--->  Attempting to fetch py27-lxml-3.2.1_0.darwin_12.x86_64.tbz2 from http://jog.id.packages.macports.org/macports/packages/py27-lxml
--->  Attempting to fetch py27-lxml-3.2.1_0.darwin_12.x86_64.tbz2.rmd160 from http://jog.id.packages.macports.org/macports/packages/py27-lxml
--->  Installing py27-lxml @3.2.1_0
--->  Activating py27-lxml @3.2.1_0
--->  Cleaning py27-lxml
--->  Fetching archive for py27-beautifulsoup4
--->  Attempting to fetch py27-beautifulsoup4-4.1.1_0+html5lib+lxml.darwin_12.noarch.tbz2 from http://jog.id.packages.macports.org/macports/packages/py27-beautifulsoup4
--->  Attempting to fetch py27-beautifulsoup4-4.1.1_0+html5lib+lxml.darwin_12.noarch.tbz2.rmd160 from http://jog.id.packages.macports.org/macports/packages/py27-beautifulsoup4
--->  Installing py27-beautifulsoup4 @4.1.1_0+html5lib+lxml
--->  Activating py27-beautifulsoup4 @4.1.1_0+html5lib+lxml
--->  Cleaning py27-beautifulsoup4
--->  Updating database of binaries: 100.0%
--->  Scanning binaries for linking errors: 100.0%
--->  No broken files found.

// for python 3.2

$ sudo port install py32-beautifulsoup4
Password:
--->  Computing dependencies for py32-beautifulsoup4
--->  Dependencies to be installed: py32-html5lib py32-distribute python32 py32-lxml libxml2 libxslt
--->  Fetching archive for python32
--->  Attempting to fetch python32-3.2.5_0.darwin_12.x86_64.tbz2 from http://jog.id.packages.macports.org/macports/packages/python32
--->  Attempting to fetch python32-3.2.5_0.darwin_12.x86_64.tbz2.rmd160 from http://jog.id.packages.macports.org/macports/packages/python32
--->  Installing python32 @3.2.5_0
--->  Activating python32 @3.2.5_0

To make python 3.2 the default (i.e. the version you get when you run 'python'), please run:

sudo port select --set python python32

--->  Cleaning python32
--->  Fetching archive for py32-distribute
--->  Attempting to fetch py32-distribute-0.6.45_0.darwin_12.noarch.tbz2 from http://jog.id.packages.macports.org/macports/packages/py32-distribute
--->  Attempting to fetch py32-distribute-0.6.45_0.darwin_12.noarch.tbz2.rmd160 from http://jog.id.packages.macports.org/macports/packages/py32-distribute
--->  Installing py32-distribute @0.6.45_0
--->  Activating py32-distribute @0.6.45_0
--->  Cleaning py32-distribute
--->  Fetching archive for py32-html5lib
--->  Attempting to fetch py32-html5lib-0.95_0.darwin_12.noarch.tbz2 from http://jog.id.packages.macports.org/macports/packages/py32-html5lib
--->  Attempting to fetch py32-html5lib-0.95_0.darwin_12.noarch.tbz2.rmd160 from http://jog.id.packages.macports.org/macports/packages/py32-html5lib
--->  Installing py32-html5lib @0.95_0
--->  Activating py32-html5lib @0.95_0
--->  Cleaning py32-html5lib
--->  Fetching archive for libxml2
--->  Attempting to fetch libxml2-2.9.0_0.darwin_12.x86_64.tbz2 from http://jog.id.packages.macports.org/macports/packages/libxml2
--->  Attempting to fetch libxml2-2.9.0_0.darwin_12.x86_64.tbz2.rmd160 from http://jog.id.packages.macports.org/macports/packages/libxml2
--->  Installing libxml2 @2.9.0_0
--->  Activating libxml2 @2.9.0_0
--->  Cleaning libxml2
--->  Fetching archive for libxslt
--->  Attempting to fetch libxslt-1.1.27_0.darwin_12.x86_64.tbz2 from http://jog.id.packages.macports.org/macports/packages/libxslt
--->  Attempting to fetch libxslt-1.1.27_0.darwin_12.x86_64.tbz2.rmd160 from http://jog.id.packages.macports.org/macports/packages/libxslt
--->  Installing libxslt @1.1.27_0
--->  Activating libxslt @1.1.27_0
--->  Cleaning libxslt
--->  Fetching archive for py32-lxml
--->  Attempting to fetch py32-lxml-3.2.1_0.darwin_12.x86_64.tbz2 from http://jog.id.packages.macports.org/macports/packages/py32-lxml
--->  Attempting to fetch py32-lxml-3.2.1_0.darwin_12.x86_64.tbz2.rmd160 from http://jog.id.packages.macports.org/macports/packages/py32-lxml
--->  Installing py32-lxml @3.2.1_0
--->  Activating py32-lxml @3.2.1_0
--->  Cleaning py32-lxml
--->  Fetching archive for py32-beautifulsoup4
--->  Attempting to fetch py32-beautifulsoup4-4.1.1_0+html5lib+lxml.darwin_12.noarch.tbz2 from http://jog.id.packages.macports.org/macports/packages/py32-beautifulsoup4
--->  Attempting to fetch py32-beautifulsoup4-4.1.1_0+html5lib+lxml.darwin_12.noarch.tbz2.rmd160 from http://jog.id.packages.macports.org/macports/packages/py32-beautifulsoup4
--->  Installing py32-beautifulsoup4 @4.1.1_0+html5lib+lxml
--->  Activating py32-beautifulsoup4 @4.1.1_0+html5lib+lxml
--->  Cleaning py32-beautifulsoup4
--->  Updating database of binaries: 100.0%
--->  Scanning binaries for linking errors: 100.0%
--->  No broken files found.
```

**Installation**

Now it is time to download the latest GooDork from git, which is requiring git<https://help.github.com/articles/set-up-git>  package (please install it via MacPorts/source beforehand):
```
$ git clone https://github.com/k3170makan/GooDork.git
Cloning into 'GooDork'...
remote: Counting objects: 80, done.
remote: Compressing objects: 100% (39/39), done.
remote: Total 80 (delta 37), reused 79 (delta 37)
Unpacking objects: 100% (80/80), done.
```

Enter the dir and here's the files:
```
$ cd GooDork/;ls -alF
total 152
drwxr-xr-x  17 xxxx  xxxx   578 Jun  8 02:45 ./
drwxr-xr-x   3 xxxx  xxxx   102 Jun  8 02:45 ../
drwxr-xr-x  13 xxxx  xxxx   442 Jun  8 02:45 .git/
-rw-r--r--   1 xxxx  xxxx  1008 Jun  8 02:45 Banner
-rw-r--r--   1 xxxx  xxxx  1483 Jun  8 02:45 EXAMPLES
-rwxr-xr-x   1 xxxx  xxxx  6801 Jun  8 02:45 GooDork.py*
-rw-r--r--   1 xxxx  xxxx   665 Jun  8 02:45 LICENSE
-rw-r--r--   1 xxxx  xxxx   998 Jun  8 02:45 NEW_FEATURES
-rwxr-xr-x   1 xxxx  xxxx  8526 Jun  8 02:45 Operator.py*
-rw-r--r--   1 xxxx  xxxx  7452 Jun  8 02:45 Operator.pyc
-rw-r--r--   1 xxxx  xxxx  2311 Jun  8 02:45 README
-rwxr-xr-x   1 xxxx  xxxx  4034 Jun  8 02:45 Result.py*
-rw-r--r--   1 xxxx  xxxx  4255 Jun  8 02:45 Result.pyc
-rwxr-xr-x   1 xxxx  xxxx   971 Jun  8 02:45 URLStripper.py*
-rw-r--r--   1 xxxx  xxxx  1490 Jun  8 02:45 URLStripper.pyc
-rwxr-xr-x   1 xxxx  xxxx  2562 Jun  8 02:45 netlib.py*
-rw-r--r--   1 xxxx  xxxx  3144 Jun  8 02:45 netlib.pyc
```

**Testing Installation**

Test it with the below command depends on your python command line settings, mine is as per follows:
```
$ python2.7 GooDork.py 
                                                                 
     _/_/_/                   _/_/_/                     _/      
  _/         _/_/     _/_/   _/    _/   _/_/   _/  _/_/ _/  _/   
 _/  _/_/ _/    _/ _/    _/ _/    _/ _/    _/ _/_/     _/_/      
_/    _/ _/    _/ _/    _/ _/    _/ _/    _/ _/       _/  _/     
 _/_/_/   _/_/     _/_/   _/_/_/     _/_/   _/       _/    _/    
                                                                 
                                                                 
                                        _             _  _______ _ _____ ____  
                                       | |__  _   _  | |/ /___ /| |___  / /\ \ 
                                       | '_ \| | | | | / /  |_ \| |  / / |  | |
                                       | |_) | |_| | | \ \ ___) | | / /| |  | |
                                       |_.__/ \__, | | |\_\____/| |/_/ | |  | |
                                              |___/  |_|        |_|     \_\/_/ 

===================================
.::GooDork::. 2.0

Usage: ./GooDork [dork] {-b[pattern]|-t[pattern]|-a[pattern]}

dork			-- google search query
pattern			-- a regular expression to search for
-b			-- search the displayable text of the dork results for 'pattern'
-t			-- search the titles of the dork results for 'pattern'
-u			-- search the urls of the dork results for 'pattern'
-a			-- search in the anchors of the dork results for 'pattern'
-L			-- Limit the amount of restults processed to the first L results
-U			-- Custom User-agent
e.g ./GooDork site:.edu -bStudents #returns urls to all pages in the .edu domain displaying 'Students'

// if you see the optional parameter above you'll know that GooDork supported in all possible
// Dork commands, for better details please see the examples that the author shares in here:
// https://github.com/k3170makan/GooDork/blob/master/EXAMPLES
// for more of base command for security purpose you can use this site as reference:
// http://new-hack4rt.blogspot.jp/2012/07/google-dork-for-finding-website-vuln.html
```

That's it! your GooDork is downloaded and "installed". It downloaded the source to be executed via python, so please setup the python environment  and the path to call the installation directory properly. In the next section we will go to the simple example and practical use for malware research purpose.

# Usage and Example #

**Basic Malware Research Usage's Example**

This section will explain some example on how to use the GooDork, this section will be properly updates with some samples too. ( I am sorry Keith, to please allow me to cut the banner for the space efficient purpose..)

**Example 1 -** Searching for the possible redirected malware url which ended with "cnt.php", let's define the search as google. The command line will be as follow:
```
$ python2.7 ./GooDork.py inurl:"cnt.php"
```
Which will burp you the below result in stdout:
```
[..banner skipped, with apology..]

===================================
[('-U', 'google-bot')]
User-Agent was set to [google-bot]
Searching >>inurl:cnt.php<<


200
OKDate: Fri, 07 Jun 2013 18:24:27 GMT
Expires: -1
Cache-Control: private, max-age=0
Content-Type: text/html; charset=ISO-8859-1
Set-Cookie: PREF=ID=f88abf28b33ff5f2:FF=0:TM=1370629467:LM=1370629467:S=TMg_PS9RzM1A1d_6; expires=Sun, 07-Jun-2015 18:24:27 GMT; path=/; domain=.google.com
Set-Cookie: NID=67=S87PEINu6bOPl1FVUnJ_TGvUeHZw2gqQvudaeM9kOPQ9s0pU7vvK2is_cvF00-o5aHQ2Cg9lPgKZbXdRk_RTD7lt5JMFs3FgtftzDClAg46sdRSIWViPTdOX2tSHxuCy; expires=Sat, 07-Dec-2013 18:24:27 GMT; path=/; domain=.google.com; HttpOnly
P3P: CP="This is not a P3P policy! See http://www.google.com/support/accounts/bin/answer.py?hl=en&answer=151657 for more info."
Server: gws
X-XSS-Protection: 1; mode=block
X-Frame-Options: SAMEORIGIN
 
['http://www.liscindianapolis.org/cnt.php%3Fid%3D179', 'http://www16.atpages.jp/kurobe29/1109/PHP/cnt.php.html', 'http://www.swgsoft.com/cnt.php', 'http://two.flash-gear.com/ncnt/cnt.php%3Fid%3D81179%26a%3D1045804613%26c%3D1479092445', 'http://www.roti.jp/en/cnt.php', 'http://code.google.com/p/sm-ecstasymusicplayer/source/browse/trunk/web-upload/cnt.php%3Fr%3D13', 
  :
```
Or..you'll see the result in file here, i.e. similar request with the other session:
```
$ head {PATH TO THE GOODORK DIR}/results.txt 
http://www.estudieenelexterior.com/new/scripts/contenidos/cnt.php?page=33&i=3
http://eintimex.org/epages/eshop270012.sf/en_GB/http/www.etracker.de/cnt.php/?ObjectPath=/Shops/eshop270012/Products/W44557&ViewAction=ViewProductDetailImage
http://count1.51much.com/cnt.php?uid=VA-1-13479&style=none
http://www.texaswoodcarversguild.com/student-cnt.php
http://www.shair-show.com/en/cnt.php?id=39
http://www.pamc.net/cnt.php
http://www.boidenzucht.com/cnt.php?cnt=abz&kat=544&PHPSESSID=kg24b8pqaep14ivrgu2cpe6l12
http://www.ehron.de/index.cnt.php%3Fid=3
    :
```
**Example 2 -** To search a blackhole exploit kit landing page of main.php in the rogue .biz domains you can use this command:
```
$ python2.7 GooDork.py inurl:main.php+site:.biz
```
The result will be:
```
[..banner skipped, with apology..]
===================================
[]
Searching >>inurl:main.php+site:.biz<<

200
OKDate: Sat, 08 Jun 2013 19:59:06 GMT
Expires: -1
Cache-Control: private, max-age=0
Content-Type: text/html; charset=ISO-8859-1
Set-Cookie: PREF=ID=13b0459e9eaccd3e:FF=0:TM=1370721546:LM=1370721546:S=R5-DcPZQDMGiFo5Z; expires=Mon, 08-Jun-2015 19:59:06 GMT; path=/; domain=.google.com
Set-Cookie: NID=67=mNl2wYVr9hHSeeInS1diKk_r_36FCzW36ZlZ-3Y_4ohEz2zKZq0iXMJe95K3-1kRBR2tGyJj8LD3FMRkPCiHWmHvST371t2DLy3HaNfXiHxqNqVZzqFtkrPx12edr47D; expires=Sun, 08-Dec-2013 19:59:06 GMT; path=/; domain=.google.com; HttpOnly
P3P: CP="This is not a P3P policy! See http://www.google.com/support/accounts/bin/answer.py?hl=en&answer=151657 for more info."
Server: gws
X-XSS-Protection: 1; mode=block
X-Frame-Options: SAMEORIGIN
 
['http://eac.biz/idb/restricted/main.php%3Fk1%3DIPs-S0', 'http://www.sryan.biz/%3Fs%3Dmain.php%3Fg2%2520fromNavId%3Dohdoqzebpmzxgj%26search_404%3D1', 'http://www.sryan.biz/%3Fs%3Dmain.php%3Fg2%2520itemId%3D1263%26search_404%3D1', 'http://www.sryan.biz/%3Fs%3Dmain.php%3Fg2%2520itemId%3D1474%26search_404%3D1', 'http://saytimiz.biz/main.php', 'http://www.ckool.biz/a/kk/main.php', 'http://todes.biz/new/full/main.php',
   :
```
**Example 3 -** If you want to seek some specific URL contains string "closest" of an Exploit Kit server which you want to look for landing page possibility with javascript in the .biz domain, but you don't want to be very honest about how you seek them, you can set the below query with setting your user agent as Mozilla as per below:
```
$ python2.7 GooDork.py inurl:closest+intext:"javascript"+site:.biz-U Mozilla
```
The output of this command will be:
```
[..banner skipped, with apology..]
===================================
[]
Searching >>inurl:closest+intext:javascript+site:.biz<<


200
OKDate: Sat, 08 Jun 2013 20:11:01 GMT
Expires: -1
Cache-Control: private, max-age=0
Content-Type: text/html; charset=ISO-8859-1
Set-Cookie: PREF=ID=26131ad06502e919:FF=0:TM=1370722261:LM=1370722261:S=5m5eOngzXDTHWplZ; expires=Mon, 08-Jun-2015 20:11:01 GMT; path=/; domain=.google.com
Set-Cookie: NID=67=ET6tAYAJuSJPtyG7X0VwT9eEF2HdJMm7CmJrGAcxYBDiiOk83DeI5tt1ea_jATro__5Di50D9e2md91QKBZ1HuiA9rqfzGscqT3bHyf1qR8f3rv4sTTgZQKOnEAD3Zpg; expires=Sun, 08-Dec-2013 20:11:01 GMT; path=/; domain=.google.com; HttpOnly
P3P: CP="This is not a P3P policy! See http://www.google.com/support/accounts/bin/answer.py?hl=en&answer=151657 for more info."
Server: gws
X-XSS-Protection: 1; mode=block
X-Frame-Options: SAMEORIGIN
 
['http://www.torontoproperty.biz/rentals/craiglist/56569-brand-new-1-bedroom-plus-den-in-limelight-(closest-building-to-sq1-mall-mississauga)-%241495-1bd-750sqft.html', 'http://www.tuugo.biz/Companies/closest-to-the-flag/0050003701356', 'http://www.jobs2careers.biz/%3Fwhat%3D%26where%3DSOUTH%2BPLAINFIELD%2BNJ%26sortby%3Dclosest', 'http://nearest-closest.lucu.biz/_a.php%3F_a%3Ddepartment%26info1%3D1', 'http://nearest-closest.lucu.biz/_a.php%3F_a%3Ddesa-kecamatan-kota%26tanda%3Dkota%26daerah%3DKab.%26urut%3D%26asc%3D000101%26sby%3D000000%26prov%3DBali%26_en%3D%26no1%3D2%26provkot%3DKota%2BDenpasar', 'http://www.venetianlasvegas.biz/las-vegas/what-cities-in-california-are-closest-to-las-vegas']
step: 101 ,results: 6
  :
```
**Example 4 -** Sometimes you will get the long output which you need to analyse each url well, thank's to @0xerror to remind me to advise the user to do the redirective output/pipe for the command like, like in Example 3 above the command line becomes:
```
$ python2.7 GooDork.py inurl:closest+intext:"javascript"+site:.biz-U MalwareMustDie > result.txt
```
Which the result.txt will contains the stdout data to be analyze and/or further automation process.

**Example 5 -** I made consultation to the author: "What if we want to check url with the specific directory path (like we used to have in Blackhole infection) like "/closest/" which the contents is included textual codes in document part or/and we are seeking for the specific domain of ".biz"? It was suggested to use the below command:
```
// Still untested successfully yet, but the "idea" is like below command:
$ python2.7 GooDork.py site:biz+inurl:/closest/ -bdocument\.
// So I assumed the usage of regex in inurl is needed like:
 inurl:\\/closest(\\/|%2F\)
// This command will be updated upon confirmed (still under test)
```
The other way to search this is using the previous method (not by regex) but using the common strings like the below command line snips:
```
$ python2.7 ./GooDork.py inurl:*.biz/closest/*.php
```
(thank's for @0xerror for the tips!)
This will burp you the good Dork result of follows:
```
[..banner skipped, with apology..]
===================================
[]
Searching >>inurl:*.biz/closest/*.php<<

200
OKDate: Wed, 12 Jun 2013 11:26:55 GMT
Expires: -1
Cache-Control: private, max-age=0
Content-Type: text/html; charset=ISO-8859-1
Set-Cookie: PREF=ID=0768a2d2163d00af:FF=0:TM=1371036415:LM=1371036415:S=xyXQjy5SCHY0LoTo; expires=Fri, 12-Jun-2015 11:26:55 GMT; path=/; domain=.google.com
Set-Cookie: NID=67=NnOZkOop4FAvygs005hzSItcPy-e849b-FsPCorAjEk0pss5Z2gmhhYWMtHDVWbRgqb_OxQKPyrHeogvS4F6C7_l0Gb8rKdVy01CXNNj4ZJZwr-1OUDpCOZryjcWvZKD; expires=Thu, 12-Dec-2013 11:26:55 GMT; path=/; domain=.google.com; HttpOnly
P3P: CP="This is not a P3P policy! See http://www.google.com/support/accounts/bin/answer.py?hl=en&answer=151657 for more info."
Server: gws
X-XSS-Protection: 1; mode=block
X-Frame-Options: SAMEORIGIN
 
['http://fetchescycle.biz/closest/incomming_message.php', 'http://atomemerged.biz/closest/f2ihoiwegjowiejf230hfaj.php', 'http://calculatetrack.biz/closest/f2ihoiwegjowiejf230hfaj.php', 'http://anxnicety.biz/closest/i9jfuhioejskveohnuojfir.php%3Fjnlp%3D0c443e4262', 'http://decentralizedscsi.biz/closest/i9jfuhioejskveohnuojfir.php%3Fzkv%3D1n:33:2v:1l:1h%26mamw%3D3h%26shlfvhgx%3D1f:30:1j:1j:1i:32:1j:1h:1l:1h%26syli%3D1n:1d:1f:1d:1f:1d:1j:1k:1l', 'http://peekwarrior.biz/closest/98yf8913fjipgjialhg8239jgighnjh4i6k5o.php', 'http://affinitystairclimbing.biz/closest/i9jfuhioejskveohnuojfir.php']
step: 101 ,results: 7
```
**Example 6 -** Recently I use GooDork to search malicious injection PHP/code in-the-wild like per snipped jinxed code example below:
```
<?php eval(gzinflate(base64_decode("DdNFDqxaAgDQvfzRe2EAFykgnR5AFe4ukw7u7qy+/
xpOTnEm/Z/qbcayT/biT5psxQf/X15kU178+ecXWxi37AlThRi1mFiDMFXJAb1ixaJAmkFjM/PqcW
[...]
```
This effort can be done by "grep" these keyword below in the inurl interface of GooDork:
```
php evalstripslashes gzinflate base64_decode
php evalstripslashes base64_decode
php eval gzinflate gzuncompress base64_decode
php eval gzinflate base64_decode
php eval gzuncompress base64_decode
php eval base64_decode
php preg_replace
php __FILE__
php echo script
php auth_pass HTTP_USER_AGENT
[...]
```
Using the above search method to find the below malware infection **real cases** as per written in the table below:
| **No** | **Description** | **Link** |
|:-------|:----------------|:---------|
| 1      | PHP Inject Code AutoGrab POST/GET | [http://pastebin.com/9M4QffML](http://pastebin.com/9M4QffML) |
| 2      | PHP Inject Code AutoGrab POST/GET + Save Posted Binary | [http://pastebin.com/bR7Eizfk](http://pastebin.com/bR7Eizfk) |
| 3      | PHP Inject Code POST/GET + Save Posted Binary + IFRAME Redirection | [http://pastebin.com/qdkVFDRP](http://pastebin.com/qdkVFDRP) |

There are other examples which we don't have a heart to publish yet, I promise the author to expand as many useful malwae research sample as possible, so please stay tune. Meanwhile please try the GooDork v2.2 and help to contribute the development of GooDork v3 (links are in the bottom of this page) :-) Thank you.

# Tips, Notes and Reference #

**Tips from the author**
```
GooDork will print out the dork its running once it gets going inbetween 
the '>>>' and '<<<' just to make sure you know what it will search.

If you have multiple search directives like...
inurl:foo site:bar filetype:php
you need to make sure they are one string, by either escaping the spaces 
or adding '+' signs instead like inurl:foo+site:bar+filetype:php or 
inurl:foo\ site:bar\ filetype:php or url encoded spaces like 
inurl:foo%20site:bar%20filetype:php
```

**Some Notes on the usage**
```
1. Be gentle in using this tool, it will harm yourself and your network environment for the reckless use.
2. The access will be monitored by Google which is having 100% right to block you from Google network.
3. Test your query well before start using the tool, use the advance search engine & urlquery beforehand.
4. For there any technical or non-technical issues due to the usage of this tool/software please contact the author accordingly.
5. If there any new idea or correction of this Wiki please DM me via @malwaremustdie (twitter).
```

**References:**

[What does GooDork 3 have to offer?](http://goo-dork.blogspot.com/2013/01/goodork3-development-is-underway.html)

[GooDork ver 2.2 Released! (Jun 9th, 2013)](https://github.com/k3170makan/GooDork/blob/master/README)

#MalwareMustDie!